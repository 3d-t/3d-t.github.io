"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[8262],{66592(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>l,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"integrations/concept","title":"Concept","description":"Overview of integration approaches in SpaceTime, including JavaScript scripts, web services, and standard connectors for connecting external data sources and devices.","source":"@site/docs/integrations/concept.md","sourceDirName":"integrations","slug":"/integrations/concept","permalink":"/docs/integrations/concept","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"description":"Overview of integration approaches in SpaceTime, including JavaScript scripts, web services, and standard connectors for connecting external data sources and devices.","keywords":["integration","JavaScript","web service","connector","API","authentication","Docker","Helm","data source"]},"sidebar":"defaultSidebar","previous":{"title":"MQTT","permalink":"/docs/import/mqtt"},"next":{"title":"Tesla","permalink":"/docs/integrations/tesla"}}');var s=n(74848),r=n(28453);const a={sidebar_position:10,description:"Overview of integration approaches in SpaceTime, including JavaScript scripts, web services, and standard connectors for connecting external data sources and devices.",keywords:["integration","JavaScript","web service","connector","API","authentication","Docker","Helm","data source"]},c="Concept",o={},d=[{value:"JavaScript",id:"javascript",level:2},{value:"Webservice",id:"webservice",level:2},{value:"Authorization",id:"authorization",level:3},{value:"Read",id:"read",level:3},{value:"Update",id:"update",level:3},{value:"JavaScript or Web Service",id:"javascript-or-web-service",level:2}];function h(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"concept",children:"Concept"})}),"\n",(0,s.jsxs)(t.p,{children:["Simple integrations can be created as discussed in the ",(0,s.jsx)(t.code,{children:"importer"})," section. You can make more complex integrations that include complex authentication, custom data processing or invokation of other web services. These integrations can be created with JavaScript or by creating a web service that supports a standard API. When the web service is deployed on the Kubernetes cluster it can be used by importers and automations."]}),"\n",(0,s.jsx)(t.h2,{id:"javascript",children:"JavaScript"}),"\n",(0,s.jsxs)(t.p,{children:["Scripts are used for relatively simple integrations that do not require intermediate caching of data or third-party integration libraries.  A script has an ",(0,s.jsx)(t.code,{children:"init"})," function that is called automatically to pass an encrypted secret. The secret may have fields for username, password or an URL. The secret is a JSON object that it created from the fields in the definition of the secret. The script should also support a ",(0,s.jsx)(t.code,{children:"get"})," function that has an object as a parameter. It should return a JSON object with information about the value of the object. You can optionally define a ",(0,s.jsx)(t.code,{children:"set"})," function. This takes the object, key and value and does something like calling another web service or sending a message. The scripts are executed an a sandbox environment on Node.js and support the ECMAScript (ECMA-262) language specification. Note that the ",(0,s.jsx)(t.code,{children:"get"})," and ",(0,s.jsx)(t.code,{children:"set"})," functions should be marked as ",(0,s.jsx)(t.code,{children:"async"})," so that they are non-blocking."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"\nclass Example {\n\n    init(secret) {\n        this.secret = secret\n    }\n\n    async get(object){\n        let result = await http.get(secret.url)\n        return {object: object, temperature: result.t, humidity: result.h}\n    }\n\n    async set(object, key, value){\n        // do something\n    }\n}\n\n"})}),"\n",(0,s.jsx)(t.h2,{id:"webservice",children:"Webservice"}),"\n",(0,s.jsx)(t.p,{children:"Web services can be created in any framework such a Python, NodeJs, Go or Java. You can use third-party packages and libraries. The service is packaged in a Docker container and a Helm chart is provided for easy installation and upgrades by users.  A web service should support the following APIs."}),"\n",(0,s.jsx)(t.h3,{id:"authorization",children:"Authorization"}),"\n",(0,s.jsx)(t.p,{children:"This call returns a list of fields that are required by the service for authentication and configuration."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"GET\n/authorization\n\ncurl http://localhost:3090/authorization\n"})}),"\n",(0,s.jsx)(t.p,{children:"Response:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'{\n    "serialnumber":"Serial number of the device",\n    "accesscode":"Access code",\n    "password":"Password that you use in the app"\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["With this call you pass the authorization information in a JSON body and an access token is returned. This token should be included in subsequent ",(0,s.jsx)(t.code,{children:"get"})," or ",(0,s.jsx)(t.code,{children:"set"})," requests."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'POST\n/token\n\ncurl -X POST -H \'Content-Type: application/json\' -i http://localhost:3090/token --data \'{"serialnumber":"112","accesscode":"123-1212","password":"secret"}\'\n'})}),"\n",(0,s.jsx)(t.p,{children:"Response:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'{\n    "Authorization":"eyJzZXJpYWxudW1iZXIiOiIxMTIiLCJhY2Nlc3Njb2RlIjoiMTIzLTEyMTIiLCJwYXNzd29yZCI6InNlY3JldCJ9"\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"read",children:"Read"}),"\n",(0,s.jsxs)(t.p,{children:["To get the values of an object use a ",(0,s.jsx)(t.code,{children:"GET"})," request where the object id is include as a path parameter and the token is included in a header called ",(0,s.jsx)(t.code,{children:"Authorization"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"GET\n/:object\n\ncurl -X GET -H 'Content-Type: application/json' -H 'Authorization: eyJzZXJpYWxudW1iZXIiOiIxMTIiLCJhY2Nlc3Njb2RlIjoiMTIzLTEyMTIiLCJwYXNzd29yZCI6InNlY3JldCJ9' -i http://localhost:3090/112\n"})}),"\n",(0,s.jsx)(t.p,{children:"Response:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n    "object": "559911827",\n    "thermostat": 15,\n    "hot_water_active": 1,\n    "outside_temperature": 19,\n    "interior_temperature": 20.3,\n    "pressure": 1.4,\n    "display": "0H-203 Standby"\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"update",children:"Update"}),"\n",(0,s.jsxs)(t.p,{children:["To set the values of an object use a ",(0,s.jsx)(t.code,{children:"PUT"})," request where the object id is include as a path parameter and keys and values are included as a JSON object in the body:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"PUT\n/:object\n\ncurl -X POST -H 'Content-Type: application/json' -H 'Authorization: eyJzZXJpYWxudW1iZXIiOiIxMTIiLCJhY2Nlc3Njb2RlIjoiMTIzLTEyMTIiLCJwYXNzd29yZCI6InNlY3JldCJ9' -i http://localhost:3090/112 --data '{\"thermostat\": \"19\"}'\n\n"})}),"\n",(0,s.jsx)(t.h2,{id:"javascript-or-web-service",children:"JavaScript or Web Service"}),"\n",(0,s.jsx)(t.p,{children:"The table below helps you to choose between the standard connector, JavaScript engine or Web service for integrating functionality. For example, if you need to make an HTTP request with basic authentication you can do this with the standard importer in combination with a secret that contains information about the authorization header that is sent with the request. If the integration requires multi pass authentication where a JSON web token is obtained this can be implemented with a script of web service. A script does not allow you to share or store any information between sessions except what is specified in a secret."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Aspect"}),(0,s.jsx)(t.th,{children:"Standard connector"}),(0,s.jsx)(t.th,{children:"JavaScript"}),(0,s.jsx)(t.th,{children:"Web service"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Ease of implementation"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"-"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Ease to making changes"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"o"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"MQTT"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"HTTP"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Use Node.js"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Simple authentication"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Multi step authentication"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Multi step authentication"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"+"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Caching and data storage"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Integration with libraries"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"+"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Use Python, C, Rust, Go, Java"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"-"}),(0,s.jsx)(t.td,{children:"+"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"In the next sections some example integrations with scripts and web services are discussed."})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453(e,t,n){n.d(t,{R:()=>a,x:()=>c});var i=n(96540);const s={},r=i.createContext(s);function a(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);