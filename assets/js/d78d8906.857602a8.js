"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[6463],{77705(e,i,n){n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"visualization/color","title":"Fixed color","description":"Apply fixed colors to nodes in a GLTF model using JavaScript expressions or direct color values, mapping IoT topic values like temperature to specific colors on building elements.","source":"@site/docs/visualization/color.md","sourceDirName":"visualization","slug":"/visualization/color","permalink":"/docs/visualization/color","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":18,"frontMatter":{"sidebar_position":18,"description":"Apply fixed colors to nodes in a GLTF model using JavaScript expressions or direct color values, mapping IoT topic values like temperature to specific colors on building elements.","keywords":["color","GLTF","digital twin","JavaScript expressions","3D visualization","IoT","nodes","building","temperature","dynamic coloring"]},"sidebar":"defaultSidebar","previous":{"title":"glTF Rewriting","permalink":"/docs/visualization/concept"},"next":{"title":"Dynamic coloring","permalink":"/docs/visualization/colormap"}}');var t=n(74848),r=n(28453);const a={sidebar_position:18,description:"Apply fixed colors to nodes in a GLTF model using JavaScript expressions or direct color values, mapping IoT topic values like temperature to specific colors on building elements.",keywords:["color","GLTF","digital twin","JavaScript expressions","3D visualization","IoT","nodes","building","temperature","dynamic coloring"]},s="Fixed color",l={},c=[{value:"Solid",id:"solid",level:2},{value:"Topics",id:"topics",level:2},{value:"Model",id:"model",level:2},{value:"Explanation",id:"explanation",level:2}];function d(e){const i={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",mermaid:"mermaid",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"fixed-color",children:"Fixed color"})}),"\n",(0,t.jsxs)(i.p,{children:["With dynamic coloring, we convert the values in the topics to a color and then apply to color to elements in the model. For example, you can show all rooms that are ",(0,t.jsx)(i.code,{children:"occupied"})," in ",(0,t.jsx)(i.code,{children:"red"})," or show the temperature inside a room with colors from blue to red.  To connect the topics to the 3D model we need to specify the name of the 3D model and the node in the 3D model to which the value applies. The model is a GLTF file that is either created with the built-in modeler or can be imported from CAD software such as Blender."]}),"\n",(0,t.jsx)(i.h2,{id:"solid",children:"Solid"}),"\n",(0,t.jsx)(i.p,{children:"In this example, we create an apartment building using the built-in solid modeler. The building includes 9 stories, a basement, and a roof."}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{src:n(40163).A+"",width:"1200",height:"600"})}),"\n",(0,t.jsx)(i.h2,{id:"topics",children:"Topics"}),"\n",(0,t.jsxs)(i.p,{children:["The main topic for this example if ",(0,t.jsx)(i.code,{children:"site.B02"}),". In the subtopic ",(0,t.jsx)(i.code,{children:"site.B02.geometry"})," we specify the name of the GLTF file. Then for each space in the building, we create three topics: the value of the temperature, the name of the node in the GLTF file, and the color."]}),"\n",(0,t.jsxs)(i.p,{children:["The topics can be imported from a file or created manually.  You need to specify the name of the model in a topic that ends with ",(0,t.jsx)(i.code,{children:"geometry"}),". All subtopics will automatically inherit the reference to the model. For each area we want to visualize we need to add a topic that ends with ",(0,t.jsx)(i.code,{children:"node"})," and enter the name of the node in the model that represents the building element that needs to be colored. In this case, we will use the nodes whose name includes ",(0,t.jsx)(i.code,{children:"IfcSpace"}),"."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"site.B02.geometry = Building.gltf\nsite.B02.area_1_a_Living.temperature = 24\nsite.B02.area_1_a_Living.node = IcfSpace_1_a_Unit_Living\nsite.B02.area_1_a_Living.color = ['blue', 'green', 'red'][Math.ceil((site.B02.area_1_a_Living.temperature - 15) / 3)]\n"})}),"\n",(0,t.jsx)(i.p,{children:"Note that the color of the node is defined by a JavaScript expression. The expression contains an array of color and the actual color is defined by the index in the array. For example,"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-Javascript",children:"['blue', 'green', 'red'][0] // 'blue'\n['blue', 'green', 'red'][2] // 'red'\n"})}),"\n",(0,t.jsxs)(i.p,{children:["The index in the array of colors is defined by the value of the topic ",(0,t.jsx)(i.code,{children:"site.B02.area_1_a_Living.temperature"}),", in this example it is ",(0,t.jsx)(i.code,{children:"24"}),". Since all temperatures in this example are between 15 and 25 degrees Celcius we first subtract the value ",(0,t.jsx)(i.code,{children:"15"})," and then divide by ",(0,t.jsx)(i.code,{children:"3"})," and then use the JavaScript ",(0,t.jsx)(i.code,{children:"Math.ceil()"})," function to convert this to an integer number."]}),"\n",(0,t.jsxs)(i.p,{children:["Instead of using a JavaScript expression, you can also specify the color directly as a text or hexadecimal value. The value of the color can be set by a JavaScript expression in the import connector, depending on the value of the ",(0,t.jsx)(i.code,{children:"temperature"})," or ",(0,t.jsx)(i.code,{children:"humidity"})," field."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"site.B02.area_1_a_Living.color = blue\nsite.B02.area_1_b_Living.color = #FF0000 \n"})}),"\n",(0,t.jsx)(i.h2,{id:"model",children:"Model"}),"\n",(0,t.jsxs)(i.p,{children:["Create a new model and specify the topics you want to visualize, for example, ",(0,t.jsx)(i.code,{children:"site.B02"}),".  All subtopics that contain the references to the geometry and nodes are included."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{src:n(29542).A+"",width:"1200",height:"750"})}),"\n",(0,t.jsx)(i.h2,{id:"explanation",children:"Explanation"}),"\n",(0,t.jsxs)(i.p,{children:["To apply dynamic coloring the topics are connected to the GLTF model and the nodes in the model. The ",(0,t.jsx)(i.code,{children:"geometry"})," subtopic defines the name of the model and the ",(0,t.jsx)(i.code,{children:"node"})," subtopic defines the name of the node. When displaying the GTLF model the topic database is queried for a topic that ends with ",(0,t.jsx)(i.code,{children:".node"})," and has the name of the node in the GLTF file as a value. If this is the case, then the database is queried for a ",(0,t.jsx)(i.code,{children:".color"})," subtopic. If this exists, the color of the mesh is set to the value of the ",(0,t.jsx)(i.code,{children:".color"})," topic."]}),"\n",(0,t.jsx)(i.mermaid,{value:"flowchart \n    direction RL\n    subgraph Topics\n        Parent[building.b01]\n        Topic[unit_1_a]\n        Geometry[.geometry \\n A.gltf]\n        Temperature[.temperature\\n22 C]\n        Color[.color\\n 66%]\n        Node[.node \\n1_A]\n        Parent --\x3e Topic\n        Parent --\x3e Geometry\n        Topic --\x3e Node\n        Topic --\x3e Color\n        Topic --\x3e Temperature\n    end\n    subgraph GLTF\n        Building[Building \\nA] --\x3e Storey[Storey \\n1]\n        Storey --\x3e Unit[Unit \\n1_A]\n        Unit --\x3e Space\n        Unit --\x3e Wall\n        Unit --\x3e Slab\n    end\n    Node --\x3e Space\n    Color --\x3e Space\n    Geometry --\x3e Building\n    style Parent fill:#fcc\n    style Topic fill:#fcc\n    style Geometry fill:#fcc\n    style Node fill:#fcc\n    style Temperature fill:#fcc\n    style Color fill:#fcc"})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},29542(e,i,n){n.d(i,{A:()=>o});const o=n.p+"assets/images/building_colorexpression_1-1ef6e2ca7d7b5556682113c3b1bdb3ba.png"},40163(e,i,n){n.d(i,{A:()=>o});const o=n.p+"assets/images/building_high-rise-5bf895df45539f935130b6c619211878.png"},28453(e,i,n){n.d(i,{R:()=>a,x:()=>s});var o=n(96540);const t={},r=o.createContext(t);function a(e){const i=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(r.Provider,{value:i},e.children)}}}]);