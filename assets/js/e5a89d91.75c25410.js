"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[511],{99711(e,i,t){t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"animation/model","title":"Transformations","description":"Build and animate parameterized 3D models for digital twins using solid primitives, topic-driven transformations, interactive forms, and CSV-based connectors, demonstrated through a shipping lock example.","source":"@site/docs/animation/model.md","sourceDirName":"animation","slug":"/animation/model","permalink":"/docs/animation/model","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":120,"frontMatter":{"sidebar_position":120,"description":"Build and animate parameterized 3D models for digital twins using solid primitives, topic-driven transformations, interactive forms, and CSV-based connectors, demonstrated through a shipping lock example.","keywords":["model transformation","solid modeler","parametric models","digital twin animation","shipping lock","IFC","glTF","topic-driven control","interactive forms","connectors","CSV import","SpaceTime"]},"sidebar":"defaultSidebar","previous":{"title":"Camera","permalink":"/docs/animation/camera"},"next":{"title":"Map orientation","permalink":"/docs/mapping/coordinates"}}');var a=t(74848),o=t(28453);const r={sidebar_position:120,description:"Build and animate parameterized 3D models for digital twins using solid primitives, topic-driven transformations, interactive forms, and CSV-based connectors, demonstrated through a shipping lock example.",keywords:["model transformation","solid modeler","parametric models","digital twin animation","shipping lock","IFC","glTF","topic-driven control","interactive forms","connectors","CSV import","SpaceTime"]},s="Transformations",l={},d=[{value:"Bridge",id:"bridge",level:2},{value:"Doors",id:"doors",level:2},{value:"Light",id:"light",level:2},{value:"Barrier",id:"barrier",level:2},{value:"Dam",id:"dam",level:2},{value:"Model",id:"model",level:2},{value:"Form",id:"form",level:2},{value:"Connector",id:"connector",level:2},{value:"Animation",id:"animation",level:2}];function c(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.header,{children:(0,a.jsx)(i.h1,{id:"transformations",children:"Transformations"})}),"\n",(0,a.jsx)(i.p,{children:"This example shows how the animation system can be used to transform models. The example shows an animation of a digital twin of a shipping lock with three bridges, traffic lights, road barriers and a ship.  The components of a digital twin can be imported as IFC or glTF files, and can also be created from scratch with the solid modeler. In this example we assume that you do not have any existing models and need to build everything yourself."}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(92175).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsx)(i.h2,{id:"bridge",children:"Bridge"}),"\n",(0,a.jsxs)(i.p,{children:["A draw bridge is constructed from block primitives. A parameter ",(0,a.jsx)(i.code,{children:"angle"})," specifies the rotation of the bridge. A part 'Fence' is included and repeated two times so that it appears at both edges of the road. The part is named ",(0,a.jsx)(i.code,{children:"Bridge"})," and stored in library ",(0,a.jsx)(i.code,{children:"T06"}),"."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(4486).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(i.p,{children:["The main topic of the animation is ",(0,a.jsx)(i.code,{children:"lock.bru"})," and the topic ",(0,a.jsx)(i.code,{children:"lock.bru.bridge"})," contains all information on the position and orientation. The angle of the bridge is defined by the topic ",(0,a.jsx)(i.code,{children:"lock.bru.bridge.angle"}),". Users can specify the angle by setting a value between ",(0,a.jsx)(i.code,{children:"0"})," for fully closed and ",(0,a.jsx)(i.code,{children:"100"})," for full opened. The special ",(0,a.jsx)(i.code,{children:"geometry"})," subtopic calls the solid by entering the name of the library, the name of the solid, and the parameter for the angle. This parameter is an expression that used the ",(0,a.jsx)(i.code,{children:"angle"})," subtopic. When the ",(0,a.jsx)(i.code,{children:"angle"})," is set to ",(0,a.jsx)(i.code,{children:"100"}),", the parameter becomes ",(0,a.jsx)(i.code,{children:"90"}),"."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-JavaScript",children:"lock.bru.bridge.angle: 0\nlock.bru.bridge.geometry: T06.Bridge(lock.bru.bridge.angle * 0.9)\nlock.bru.bridge.translation: -95, 22, 10\nlock.bru.bridge.rotation: 0, 0, 270\n"})}),"\n",(0,a.jsx)(i.h2,{id:"doors",children:"Doors"}),"\n",(0,a.jsxs)(i.p,{children:["The shipping lock has two sets of door, one for the lakeside and one for the seaside. Each set of doors includes four doors. The solid has a parameter ",(0,a.jsx)(i.code,{children:"angle"})," that specifies the opening of the lock: ",(0,a.jsx)(i.code,{children:"0"})," means fully closed and ",(0,a.jsx)(i.code,{children:"90"})," means fully opened. Note that the ",(0,a.jsx)(i.code,{children:"angle"})," parameter is not used directly to control the rotation of the doors but is used in an expression for variable ",(0,a.jsx)(i.code,{children:"a"})," so that the actual angle is between ",(0,a.jsx)(i.code,{children:"5"})," and ",(0,a.jsx)(i.code,{children:"85"})," degrees, regardless of the user input. The difference between parameters and variables is that parameters can be specified externally, while variables are only used internally in the script for the solid."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(21212).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(i.p,{children:["The topics that control the lock doors on the lakeside are defined below. The status of the lock is defined by the ",(0,a.jsx)(i.code,{children:"lock.bru.lake.lock.angle"})," topic. The door set is moved ",(0,a.jsx)(i.code,{children:"-90"})," units along the x-axis."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-javascript",children:"lock.bru.lake.lock.angle: 0\nlock.bru.lake.lock.geometry: T06.Door set(lock.bru.lake.lock.angle * 0.9)\nlock.bru.lake.lock.translation.x: -90,\n"})}),"\n",(0,a.jsx)(i.h2,{id:"light",children:"Light"}),"\n",(0,a.jsxs)(i.p,{children:["There are two light signals on the lakeside of the lock. The solid ",(0,a.jsx)(i.code,{children:"Light lock"})," includes a part ",(0,a.jsx)(i.code,{children:"Trafic light 2"})," which has parameters for the color of the top light and the color of the bottom light. Instead of controlling the colors of both the top and bottom light we use a parameter ",(0,a.jsx)(i.code,{children:"state"}),", which can be ",(0,a.jsx)(i.code,{children:"stop"}),", ",(0,a.jsx)(i.code,{children:"prepare"})," or ",(0,a.jsx)(i.code,{children:"proceed"}),". Three ",(0,a.jsx)(i.code,{children:"if"})," statements are used to set the color of the top and bottom light, depending on the state."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(20605).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(i.p,{children:["There are topics for the left and right-hand light of the lake entrance of the dock. The state of both lights are controlled by the topic ",(0,a.jsx)(i.code,{children:"lock.bru.lake.light.state"}),"."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-javascript",children:"lock.bru.lake.light.state: 'stop'\nlock.bru.lake.light.right.geometry: T06.Light lock(lock.bru.lake.light.state)\nlock.bru.lake.light.right.translation: -109, 4, 8\nlock.bru.lake.light.right.rotation: 0, 0, 180\nlock.bru.lake.light.right.scale: 2, 2, 2\n"})}),"\n",(0,a.jsx)(i.h2,{id:"barrier",children:"Barrier"}),"\n",(0,a.jsxs)(i.p,{children:["There are two sets of road barriers for the draw bridge and for the roll bridge. The solid ",(0,a.jsx)(i.code,{children:"Barrier set"})," includes two solids ",(0,a.jsx)(i.code,{children:"Barrier"}),", with a parameter ",(0,a.jsx)(i.code,{children:"angle"}),", and two solids ",(0,a.jsx)(i.code,{children:"Traffic pole bridge"}),", with a parameter for the color of the light."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(66217).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(i.p,{children:["The topics for the position and status of the right lakeside barrier include the color of the light and the angle of the barrier as a percentage between ",(0,a.jsx)(i.code,{children:"0"})," and ",(0,a.jsx)(i.code,{children:"100"}),"."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-javascript",children:"lock.bru.lake.barrier.angle: 0\nlock.bru.lake.barrier.color: 'red'\nlock.bru.lake.barrier.right.geometry: Infra.Barrier set(lock.bru.lake.barrier.angle * 0.9, lock.bru.lake.barrier.color)\nlock.bru.lake.barrier.right.translation: -95, -10, 10.5\nlock.bru.lake.barrier.right.rotation: 0, 0, 270\n"})}),"\n",(0,a.jsx)(i.h2,{id:"dam",children:"Dam"}),"\n",(0,a.jsxs)(i.p,{children:["The shape of the dam is created by a solid ",(0,a.jsx)(i.code,{children:"Base"})," for the shape of the lock. This shape is created by extruding a profile with the shape of the slanted terrain and the channel in the lock. Some other wedges and blocks are added to the left and right as a base for the road."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(90315).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsx)(i.p,{children:"Note that this solid does not have any parameters. Instead of linking the geometry to the name of the script we can include a static glTF file. This file is automatically created when the solid is saved. The advantage of using static glTF files over solids is that the rendering is faster."}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-javascript",children:"lock.bru.terrain.geometry: T06.Dam.gltf,\n"})}),"\n",(0,a.jsx)(i.h2,{id:"model",children:"Model"}),"\n",(0,a.jsxs)(i.p,{children:["To create an animation a new model is created and all topics for the various elements are loaded in the topic view.\nTo change the angle of the bridge you can open the topic ",(0,a.jsx)(i.code,{children:"lock.bru.bridge.angle"})," in another browser and set the value to ",(0,a.jsx)(i.code,{children:"45"}),". The model should be updated automatically since it is automatically subscribed to updates of all topics that are included in the model."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(33067).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsx)(i.h2,{id:"form",children:"Form"}),"\n",(0,a.jsxs)(i.p,{children:["As an alternative to entering new topic values with the keyboard you can also create the following form. All topics are relative to the main topic ",(0,a.jsx)(i.code,{children:"lock.bru"}),"."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-javascript",children:"Lock\n\nlake.light.state:Lake lock light\n[\nprepare,\nproceed,\nstop,\n]\n|6\n\nsea.light.state:Sea lock light\n[\nprepare,\nproceed,\nstop,\n]\n|6\n\nlake.barrier.angle:Lake barrier\n[0|100]\n|6\n\nsea.barrier.angle:Sea barrier\n[0|100]\n|6\n\nfootbridge.extension:Foot bridge\n[0|100]\n|6\n\nrollbridge.extension:Roll Bridge\n[0|100]\n|6\n\nlake.lock.angle:Lake lock\n[0|100]\n|6\n\nsea.lock.angle:Sea lock\n[0|100]\n|6\n\nbridge.angle:Draw Bridge\n[0|100]\n\nwater.level:Water level\n[0|10]\n\nship.position:Schip position\n[0|400]\n"})}),"\n",(0,a.jsxs)(i.p,{children:["To open the form go to the ",(0,a.jsx)(i.code,{children:"items"})," section and search for ",(0,a.jsx)(i.code,{children:"lock.bru"}),". When clicking on the item the system searches for forms that match any subtopics in the item. In this case the form above with name ",(0,a.jsx)(i.code,{children:"Lock"})," is opened. You can now drive the animation by changing the values of the sliders and drop-down menus."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(40745).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsx)(i.h2,{id:"connector",children:"Connector"}),"\n",(0,a.jsxs)(i.p,{children:["You can also automatically update the model by creating a connector that updates the various subtopics under ",(0,a.jsx)(i.code,{children:"lock.bru"}),". For example, the connector can update the water level by making a call to a web service with real time water level information. In this example we set the values of the topics by importing a CSV file. The file has three headers: ",(0,a.jsx)(i.code,{children:"topic"}),", ",(0,a.jsx)(i.code,{children:"time"})," and ",(0,a.jsx)(i.code,{children:"value"}),". When running the connector the name of the topic is defined by the expression in the ",(0,a.jsx)(i.code,{children:"key"})," field. In this case it is ",(0,a.jsx)(i.code,{children:"lock.bru"})," followed by the value in the first column of the CSV file. The time is set to a fixed date ",(0,a.jsx)(i.code,{children:"2024-01-01"})," plus the value in the ",(0,a.jsx)(i.code,{children:"time"})," column multiplied by 1000. This is because the time is specified in milliseconds. Click ",(0,a.jsx)(i.code,{children:"test"})," to check that all topics, values and times are correct and then ",(0,a.jsx)(i.code,{children:"Run"})," to actually import the data."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(96832).A+"",width:"1200",height:"800"})}),"\n",(0,a.jsx)(i.h2,{id:"animation",children:"Animation"}),"\n",(0,a.jsxs)(i.p,{children:["To start the animation, click on the ",(0,a.jsx)(i.code,{children:"Time"})," tab and include all topics that you want to animate. Note that in this example we have disabled animation of the camera position and target. Next, specify the start and end time for collecting historical data on the topics listed. When ready click on the ",(0,a.jsx)(i.code,{children:"Animate"})," button."]}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{src:t(92175).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(i.p,{children:["Note: You can also watch a video of this animation is the ",(0,a.jsx)(i.a,{href:"/docs/video",children:"video section"}),". This video includes more details on the setup and also shows the view from inside a ship in the lock by enabling the camera animation."]})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},96832(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_connector_lock-1f29cfce070ecd42d2755557a3ba71c4.png"},40745(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_form_lock-47e36994469d301f11c7afa235dd8548.png"},66217(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_lock_barrier_set-4fe9befc7313af3bba03c63960acda5e.png"},4486(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_lock_bridge-859f4e7aa02a206f5e0dc9cdffef7182.png"},90315(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_lock_dam-a9bf15f3589f32f3051221f73f39d504.png"},21212(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_lock_door_set-8323dc88fdf28e95816c44550f97af87.png"},92175(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_lock_frames-b4c9053bb0913fe055e3d0088f9ac5da.png"},20605(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_lock_light-3582e0b74421e97ba10ad327fafab135.png"},33067(e,i,t){t.d(i,{A:()=>n});const n=t.p+"assets/images/animation_topics_lock-adfe909e8f776e76b379db700d2e97e9.png"},28453(e,i,t){t.d(i,{R:()=>r,x:()=>s});var n=t(96540);const a={},o=n.createContext(a);function r(e){const i=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);