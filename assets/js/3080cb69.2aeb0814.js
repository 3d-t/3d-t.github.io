"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[3106],{41085(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"integrations/tesla","title":"Tesla","description":"Bi-directional integration with the Tesla Fleet API for reading vehicle data such as battery level and location, and sending commands for charging and climate control.","source":"@site/docs/integrations/tesla.md","sourceDirName":"integrations","slug":"/integrations/tesla","permalink":"/docs/integrations/tesla","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"description":"Bi-directional integration with the Tesla Fleet API for reading vehicle data such as battery level and location, and sending commands for charging and climate control.","keywords":["Tesla","electric vehicle","Fleet API","charging","climate control","battery","vehicle data","EV","automation"]},"sidebar":"defaultSidebar","previous":{"title":"Concept","permalink":"/docs/integrations/concept"},"next":{"title":"Home Assistant","permalink":"/docs/integrations/homeassistant"}}');var a=t(74848),s=t(28453);const i={sidebar_position:20,description:"Bi-directional integration with the Tesla Fleet API for reading vehicle data such as battery level and location, and sending commands for charging and climate control.",keywords:["Tesla","electric vehicle","Fleet API","charging","climate control","battery","vehicle data","EV","automation"]},o="Tesla",c={},l=[{value:"Register the app with Tesla developer",id:"register-the-app-with-tesla-developer",level:2},{value:"Installation",id:"installation",level:2},{value:"Datasource",id:"datasource",level:2},{value:"Connector",id:"connector",level:2},{value:"Form",id:"form",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"tesla",children:"Tesla"})}),"\n",(0,a.jsx)(n.p,{children:"The Tesla fleet API is an officially supported API for accessing vehicle data and sending commands to the vehicle."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(4403).A+"",width:"2732",height:"1802"})}),"\n",(0,a.jsx)(n.h2,{id:"register-the-app-with-tesla-developer",children:"Register the app with Tesla developer"}),"\n",(0,a.jsxs)(n.p,{children:["Setup an account at ",(0,a.jsx)(n.a,{href:"https://developer.tesla.com",children:"https://developer.tesla.com"})," with the credentials from your Tesla vehicle. Submit an access request for using the API. In the request you can identify the scope, for example only read vehicle data or also send commands. You also need to specify the URI from which the API can be called. This is the domain of where the server is hosted. After the application has been approved you can obtain the CLIENT_ID and CLIENT_SECRET codes. For more information see this ",(0,a.jsx)(n.a,{href:"https://shankarkumarasamy.blog/2023/10/29/tesla-developer-api-guide-account-setup-app-creation-registration-and-third-party-authentication-configuration-part-1/",children:"blog"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.p,{children:"To run the service in Docker:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker run --rm -p 80:80 -v /persist:/persist spacetimehub/tesla\n"})}),"\n",(0,a.jsx)(n.p,{children:"To run the service in Kubernetes:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"helm install tesla spacetime/tesla\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Once the service is running register your credentials. For ",(0,a.jsx)(n.code,{children:"region"})," select ",(0,a.jsx)(n.code,{children:"eu"})," (Europe), ",(0,a.jsx)(n.code,{children:"na"})," (North America), or ",(0,a.jsx)(n.code,{children:"cn"})," (China). The service should point to the public URL accessible to Tesla, for example ",(0,a.jsx)(n.code,{children:"https://tesla.mydomain.com"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST -k -H \'Content-Type: application/json\' -i \'https://tesla.<YOURDOMAIN>/register\' --data \'{"clientId": <CLIENT_ID>,  "clientSecret": <CLIENT_SECRET>,  "region":<REGION>, "service":<URL>}\'\n'})}),"\n",(0,a.jsx)(n.p,{children:"The response is an authentication URL. Paste this URL in web browser and login to your tesla account to authorize the service to access your vehicle."}),"\n",(0,a.jsx)(n.h2,{id:"datasource",children:"Datasource"}),"\n",(0,a.jsx)(n.p,{children:"Create a new datasource with the following information:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"name"}),(0,a.jsx)(n.th,{children:"value"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"type"}),(0,a.jsx)(n.td,{children:"webservice"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"service"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.a,{href:"https://tesla.YOURDOMAIN",children:"https://tesla.YOURDOMAIN"})})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"connector",children:"Connector"}),"\n",(0,a.jsxs)(n.p,{children:["In the connector specify the secret that contains the Tesla data source. Add an object mapping for each device. The object ID is the VIN (Vehicle Identification Number) of the car. There is a custom field ",(0,a.jsx)(n.code,{children:"charging"})," which is not supplied by the input data but is set to ",(0,a.jsx)(n.code,{children:"0"})," or ",(0,a.jsx)(n.code,{children:"1"})," depending on the charging power. This field will be used to start or stop the charging process. The field ",(0,a.jsx)(n.code,{children:"charge_level_soc"}),", which indicates the user selected charging level, is renamed to ",(0,a.jsx)(n.code,{children:"charge_level"}),". Furthermore, the ",(0,a.jsx)(n.code,{children:"odometer"})," field has a conversion factor from miles to kilometers."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(97235).A+"",width:"2732",height:"1802"})}),"\n",(0,a.jsxs)(n.p,{children:["The exporter contains an entry for setting the ",(0,a.jsx)(n.code,{children:"charge_level"})," and for starting and stopping the charging process via the key ",(0,a.jsx)(n.code,{children:"charging"}),", and ",(0,a.jsx)(n.code,{children:"climate"})," to turn on the climate system. For security reasons some commands like opening the doors and starting the car are not enabled in the API but these can be added if necessary."]}),"\n",(0,a.jsx)(n.h2,{id:"form",children:"Form"}),"\n",(0,a.jsxs)(n.p,{children:["To control the Tesla create a form with three pages and open the item ",(0,a.jsx)(n.code,{children:"tesla.model_s"}),". The first page has some overall information but does not include any controls."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Tesla\n\nSpeed\n<speed\n[000 kmh]\n\nPower\n<power\n[000 kW]\n\nOdometer\n<odometer\n[000000]\n\nDrive\n<shift_state\n\nBattery level\n<battery_level\n[0|10:red,11|20:orange,21|100:green]\n\nBattery range\n<battery_range\n[0|50:red,50|100:orange,100|600:green 000]\n\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(14529).A+"",width:"2732",height:"1802"})}),"\n",(0,a.jsxs)(n.p,{children:["The second and third pages include controls for the climate and charging. To modify any of the parameters open the item ",(0,a.jsx)(n.code,{children:"tesla.model_s"})," and click on the ",(0,a.jsx)(n.code,{children:"edit"})," button. After making changes click on ",(0,a.jsx)(n.code,{children:"save"})," to execute the changes."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"--\x3e\nClimate\n[powerbutton]\n|6\n\nDefrost\n<is_preconditioning\n[powerbutton]\n|6\n\nThermostat driver\n[15|25]\n\nThermostat passenger\n[15|25]\n\nseat_heater_left\n[0|3]\n\nseat_heater_right\n[0|3]\n\nseat_heater_rear_left\n[0|3]\n|4\n\nseat_heater_rear_center\n[0|3]\n|4\n\nseat_heater_rear_right\n[0|3]\n|4\n\nOutside temp\n<exterior_temperature\n[0|10:purple,11|17:blue,18|21:green,22|25:red]\n\nInside temp\n<interior_temperature\n[0|10:purple,11|17:blue,18|21:green,22|25:red]\n\n--\x3e\n\nBattery level\n<battery_level\n[0|10:red,11|20:orange,21|100:green]\n\nBattery range\n<battery_range\n[0|50:red,50|100:orange,100|600:green 000]\n\nCharge limit\n[50|100]\n|12\n\nCharge amps\n[0|20]\n|12\n\nPower\n<charger_power\n[000 kWh]\n|4\n\nVoltage\n<charger_voltage\n[000 V]\n|4\n\nCurrent\n<charger_current\n[00.0 A]\n|4\n\nCharging state\n<charging_state\n|6\n\nCharging\n[powerbutton]\n|6\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(49194).A+"",width:"2732",height:"1802"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},97235(e,n,t){t.d(n,{A:()=>r});const r=t.p+"assets/images/connector_tesla-f5357b2a79a59f8df7764158d625ab37.png"},14529(e,n,t){t.d(n,{A:()=>r});const r=t.p+"assets/images/item_tesla_1-fa5f921b9096c8008d7ddec08eac766b.png"},49194(e,n,t){t.d(n,{A:()=>r});const r=t.p+"assets/images/item_tesla_2-b22c3ce0f7c84bed5365828f7fe17e06.png"},4403(e,n,t){t.d(n,{A:()=>r});const r=t.p+"assets/images/item_tesla_3-0539a59d9841fb85218e9482b2b989a6.png"},28453(e,n,t){t.d(n,{R:()=>i,x:()=>o});var r=t(96540);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);