(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7336],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return d}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),l=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=l(e.components);return o.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),m=l(n),d=a,h=m["".concat(s,".").concat(d)]||m[d]||u[d]||i;return n?o.createElement(h,r(r({ref:t},p),{},{components:n})):o.createElement(h,r({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,r[1]=c;for(var l=2;l<i;l++)r[l]=n[l];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9556:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return s},metadata:function(){return l},toc:function(){return p},default:function(){return m}});var o=n(2122),a=n(9756),i=(n(7294),n(3905)),r=["components"],c={sidebar_position:10},s="Controlling devices",l={unversionedId:"automation/control",id:"automation/control",isDocsHomePage:!1,title:"Controlling devices",description:"Once the connectors are setup you can control devices by changing the state. Instead of doing the manually for each state you can create automations that set multiple states at once and can be run automatically at scheduled intervals. Automations are created with a visual programming environment based on Google blockly which creates JavaScript code that is executed on the server. You can create the automations by dragging and dropping components like conditional statements or loops.",source:"@site/docs/automation/control.md",sourceDirName:"automation",slug:"/automation/control",permalink:"/docs/automation/control",version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"defaultSidebar",previous:{title:"Arduino",permalink:"/docs/integrations/arduino"},next:{title:"Conditional statements",permalink:"/docs/automation/conditionals"}},p=[{value:"Automation",id:"automation",children:[]},{value:"Linking automations to topics",id:"linking-automations-to-topics",children:[]},{value:"Panel",id:"panel",children:[]}],u={toc:p};function m(e){var t=e.components,c=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},u,c,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"controlling-devices"},"Controlling devices"),(0,i.kt)("p",null,"Once the connectors are setup you can control devices by changing the state. Instead of doing the manually for each state you can create automations that set multiple states at once and can be run automatically at scheduled intervals. Automations are created with a visual programming environment based on ",(0,i.kt)("a",{parentName:"p",href:"https://developers.google.com/blockly/"},"Google blockly")," which creates JavaScript code that is executed on the server. You can create the automations by dragging and dropping components like conditional statements or loops."),(0,i.kt)("h2",{id:"automation"},"Automation"),(0,i.kt)("p",null,"From the side menu select ",(0,i.kt)("inlineCode",{parentName:"p"},"Automation")," and create a new automation. Click on the ",(0,i.kt)("inlineCode",{parentName:"p"},"control")," area in the visual editor. Drag and drop the ",(0,i.kt)("inlineCode",{parentName:"p"},"Set")," control to the workspace. From the same ",(0,i.kt)("inlineCode",{parentName:"p"},"control")," drag the dropdown topic selector to the first field of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Set")," control. You can now select a topic via a drop down menu. After selecting a topic you can select a sub topic."),(0,i.kt)("p",null,"From the ",(0,i.kt)("inlineCode",{parentName:"p"},"Variables")," section drag the ",(0,i.kt)("inlineCode",{parentName:"p"},"on\\off")," dropdown and the ",(0,i.kt)("inlineCode",{parentName:"p"},"color")," dropdown into the second field of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Set")," controls. When ready click on the ",(0,i.kt)("inlineCode",{parentName:"p"},"Run")," icon to execute the automation. "),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(955).Z})),(0,i.kt)("h2",{id:"linking-automations-to-topics"},"Linking automations to topics"),(0,i.kt)("p",null,"Instead of running an automation manually to control a number of items you can also run an automation by creating a form with a button. In the example below we have selected the item ",(0,i.kt)("inlineCode",{parentName:"p"},"Parameter")," from the ",(0,i.kt)("inlineCode",{parentName:"p"},"Variables")," menu. The parameter has a name ",(0,i.kt)("inlineCode",{parentName:"p"},"on")," which is used in a conditional statement that can be found under the ",(0,i.kt)("inlineCode",{parentName:"p"},"Logic")," section. When the parameter ",(0,i.kt)("inlineCode",{parentName:"p"},"on")," is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," it turns on a switch and sets a color to ",(0,i.kt)("inlineCode",{parentName:"p"},"green"),". So, in fact it functions as a master switch to control multiple devices."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(3570).Z})),(0,i.kt)("p",null,"Next we create two new topics for the master switch. On topic specifies the state ",(0,i.kt)("inlineCode",{parentName:"p"},"on")," as ",(0,i.kt)("inlineCode",{parentName:"p"},"0")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),". A second topic links the masterswitch to the name of the automation. If a topic has a subtopic called ",(0,i.kt)("inlineCode",{parentName:"p"},"automation")," this automation is executed when the state of the sibling topics change. In this case it is the topic ",(0,i.kt)("inlineCode",{parentName:"p"},"offce.htc.reception.masterswitch.on"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"offce.htc.reception.masterswitch.automation = Office master switch\noffce.htc.reception.masterswitch.on = 0\n")),(0,i.kt)("p",null,"When you change the state of the ",(0,i.kt)("inlineCode",{parentName:"p"},"on")," field from ",(0,i.kt)("inlineCode",{parentName:"p"},"0")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"1")," it now will execute the automation."),(0,i.kt)("h2",{id:"panel"},"Panel"),(0,i.kt)("p",null,"We can now create a new form with the user interface for the power switch. The definition includes the name of the form and a control. The control has a key ",(0,i.kt)("inlineCode",{parentName:"p"},"on")," and a label ",(0,i.kt)("inlineCode",{parentName:"p"},"Power")," and we define the type of control as ",(0,i.kt)("inlineCode",{parentName:"p"},"powerbutton"),". Make sure you add the word ",(0,i.kt)("inlineCode",{parentName:"p"},"panel")," to the name of the form because this ensures that the form will open in panel mode, which means that editing of the form is enabled and changes to controls are immediately executed. If you do not add ",(0,i.kt)("inlineCode",{parentName:"p"},"panel")," to the form name you first have to set the form in ",(0,i.kt)("inlineCode",{parentName:"p"},"edit")," mode, press the button and than click ",(0,i.kt)("inlineCode",{parentName:"p"},"save")," to execute the changes. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Office masterswitch panel\n\non:Power\n[powerbutton]\n")),(0,i.kt)("p",null,"After the form is saved you can now select ",(0,i.kt)("inlineCode",{parentName:"p"},"Items")," from the navigation menu and search for ",(0,i.kt)("inlineCode",{parentName:"p"},"office.htc.reception.masterswitch"),". If you click on the item the new form is automatically opened. This is because the name of the subtopics are matched with the names of available forms."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(6907).Z})))}m.isMDXComponent=!0},3570:function(e,t,n){"use strict";t.Z=n.p+"assets/images/automation_masterswitch-6e47323992c39aa725e6ee4c16f4c218.png"},6907:function(e,t,n){"use strict";t.Z=n.p+"assets/images/automation_masterswitch_item-24ae01a077ace7705dc15eaf9ed6b394.png"},955:function(e,t,n){"use strict";t.Z=n.p+"assets/images/automation_scene-2841908da5cb7f58a579a835e9e6c86f.png"}}]);