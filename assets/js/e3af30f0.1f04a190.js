"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5389],{61561(e,t,i){i.r(t),i.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"visualization/lights","title":"Light","description":"Visualize IoT parameters by controlling the emissive color and intensity of lights in a GLTF model, demonstrated with a railway signal whose lights change based on topic values.","source":"@site/docs/visualization/lights.md","sourceDirName":"visualization","slug":"/visualization/lights","permalink":"/docs/visualization/lights","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"sidebar_position":30,"description":"Visualize IoT parameters by controlling the emissive color and intensity of lights in a GLTF model, demonstrated with a railway signal whose lights change based on topic values.","keywords":["lights","emissive","GLTF","digital twin","railway signal","IoT","JavaScript expressions","3D visualization","smart city","traffic"]},"sidebar":"defaultSidebar","previous":{"title":"Dynamic coloring","permalink":"/docs/visualization/colormap"},"next":{"title":"Textures","permalink":"/docs/visualization/textures"}}');var a=i(74848),s=i(28453);const o={sidebar_position:30,description:"Visualize IoT parameters by controlling the emissive color and intensity of lights in a GLTF model, demonstrated with a railway signal whose lights change based on topic values.",keywords:["lights","emissive","GLTF","digital twin","railway signal","IoT","JavaScript expressions","3D visualization","smart city","traffic"]},l="Light",r={},c=[{value:"Solids",id:"solids",level:2},{value:"Topics",id:"topics",level:2},{value:"Form",id:"form",level:2},{value:"Model",id:"model",level:2},{value:"Explanation",id:"explanation",level:2}];function h(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",mermaid:"mermaid",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"light",children:"Light"})}),"\n",(0,a.jsx)(t.p,{children:"In this example, we show how you can visualize IoT parameters by setting the intensity and color of lights. You can use this to visualize traffic signs in a smart city or show warning signs."}),"\n",(0,a.jsx)(t.h2,{id:"solids",children:"Solids"}),"\n",(0,a.jsxs)(t.p,{children:["If you do not have a GLTF model of a railway sign you can create one with the built-in solid modeler. First, create the lamp from two flat cylinders and a flat block. The slanted cylinders are created by subtracting a cylinder from a slightly larger cylinder. The result, a hollow cylinder, is combined with a ",(0,a.jsx)(t.code,{children:"Wegde"})," using the ",(0,a.jsx)(t.code,{children:"Intersect"})," operation."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:i(60185).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(t.p,{children:["The three lights are created with a repeat statement that includes the text ",(0,a.jsx)(t.code,{children:"top, center, bottom"}),". This creates three objects that are named ",(0,a.jsx)(t.code,{children:"top"}),", ",(0,a.jsx)(t.code,{children:"center"}),", and ",(0,a.jsx)(t.code,{children:"bottom"}),". These names are used to link the topics to the geometry in the solid. The final solid is stored as ",(0,a.jsx)(t.code,{children:"Lamp"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:i(20450).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsxs)(t.p,{children:["The signal is created by adding the ",(0,a.jsx)(t.code,{children:"Lamp"})," to a tall cylinder that represents the pole. The stairs are created by a repeat statement that creates steps. The new object is saved as ",(0,a.jsx)(t.code,{children:"Signal"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["The\n",(0,a.jsx)(t.img,{src:i(87875).A+"",width:"1200",height:"750"})]}),"\n",(0,a.jsxs)(t.p,{children:["The railway station is created by two large blocks that form the platforms on both sides. The street lights and tracks are created separately and are included. The ",(0,a.jsx)(t.code,{children:"move"})," blocks are used to arrange the parts on the platform. Finally, the part ",(0,a.jsx)(t.code,{children:"Signal"})," is included and positioned in the front. Note that the signal only shows the default colors that have been defined in the model. Next, we will connect the color of the lights to the value of the topics."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:i(45867).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsx)(t.h2,{id:"topics",children:"Topics"}),"\n",(0,a.jsxs)(t.p,{children:["The main topic ",(0,a.jsx)(t.code,{children:"railway.station"})," has a subtopic ",(0,a.jsx)(t.code,{children:"geometry"})," that includes the name of the GLTF file. It also has a subtopic ",(0,a.jsx)(t.code,{children:"signal"})," that indicates the color of the signal. The signal has three sub topics, that represent the top, center and bottom lights. Each light is connected to a node in the GLTF model that has the geometry of the light, in this case a small cylinder that emits light. Each light also has a subtopic that contains the value of the color of the light. You can specify the color of each light by entering a JavaScript expression that may include values of other topics. In this case, we use a ternary expression that looks up the value of the topic ",(0,a.jsx)(t.code,{children:"railway.station.signal"}),". If the value matches the color defined in the topic the light will emit that color, otherwise it is turned to black."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"railway.station.name = Station L01\nrailway.station.geometry = Station.gltf\nrailway.station.signal = clear\n\nrailway.station.signal.top.node = Signal_Lamp_top\nrailway.station.signal.top.emissive = railway.station.signal === 'clear' ? 'green' : 'black'\n\nrailway.station.signal.center.node = Signal_Lamp_center\nrailway.station.signal.center.emissive = railway.station.signal === 'caution' ? 'orange' : 'black'\n\nrailway.station.signal.bottom.node = Signal_Lamp_bottom\nrailway.station.signal.bottom.emissive = railway.station.signal === 'stop' ? 'green' : 'black'\n"})}),"\n",(0,a.jsx)(t.h2,{id:"form",children:"Form"}),"\n",(0,a.jsx)(t.p,{children:"To control the value of the signal we create a form for the railway station that includes the color of the signal."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"Station\n\nName\n\nSignal\n[\nclear,\ncaution,\nstop\n]\n"})}),"\n",(0,a.jsx)(t.h2,{id:"model",children:"Model"}),"\n",(0,a.jsxs)(t.p,{children:["Create a new model and include the main topic ",(0,a.jsx)(t.code,{children:"railway.station"}),". The model opens and the three lights of the signal are recolored so that only the center light shows orange. When you double-click on the sign the form opens. Select the ",(0,a.jsx)(t.code,{children:"edit"})," icon and change the value to ",(0,a.jsx)(t.code,{children:"red"})," or ",(0,a.jsx)(t.code,{children:"green"}),". When you update the model the center light turns off and one of the other lights will be activated."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:i(61257).A+"",width:"1200",height:"750"})}),"\n",(0,a.jsx)(t.h2,{id:"explanation",children:"Explanation"}),"\n",(0,a.jsxs)(t.p,{children:["The lighting is controlled by setting the ",(0,a.jsx)(t.code,{children:"emissive"})," color property of nodes in the GTLF file. The color can either be a string like ",(0,a.jsx)(t.code,{children:"purple"})," or a hexadecimal value such as ",(0,a.jsx)(t.code,{children:"#ff00ff"}),". When rendering the model, a lookup is made for the name of each node in the 3D model to see if there is a topic ending with ",(0,a.jsx)(t.code,{children:".node"})," and a value identical to the name of the node. If this is true, a topic is searched with the same parent topic that ends with ",(0,a.jsx)(t.code,{children:"emissive"}),". For example, the following topics would set the emissive color of a node named ",(0,a.jsx)(t.code,{children:"Signal_Lamp_top"})," to ",(0,a.jsx)(t.code,{children:"blue"}),":"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"railway.station.signal.top.node = Signal_Lamp_top\nrailway.station.signal.top.emissive = blue \n"})}),"\n",(0,a.jsxs)(t.p,{children:["Instead of entering a fixed color, you can also set the color via a JavaScript expression that takes the value of another topic. For example, we can use a single topic ",(0,a.jsx)(t.code,{children:"Signal"})," to control the value of the ",(0,a.jsx)(t.code,{children:"emissive"})," property:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"railway.station.signal = orange\nrailway.station.signal.top.emissive = railway.station.signal === 'clear' ? 'green' : 'black'\n"})}),"\n",(0,a.jsx)(t.p,{children:"The chart below shows how the topics and subtopics are linked to the nodes in the GLTF model."}),"\n",(0,a.jsx)(t.mermaid,{value:"flowchart \n    direction TB\n    subgraph Topics\n        Station[railway.station]\n        Signal[.signal \\n orange]\n        Geometry[.geometry \\n A.gltf]\n        Station --\x3e Signal\n        Station --\x3e Geometry\n    end\n    subgraph GLTF\n        direction TB\n        GLTFStation[Station] --\x3e GLTFSignal\n        GLTFSignal[Signal] --\x3e Lamp\n        Lamp --\x3e Top\n        Lamp --\x3e Center\n        Lamp --\x3e Bottom\n    end\n    Geometry --\x3e GLTFStation\n    Top --JavaScript expression--\x3e Signal\n    Center --JavaScript expression--\x3e Signal\n    Bottom --JavaScript expression--\x3e Signal\n    style Station fill:#fcc\n    style Signal fill:#fcc\n    style Geometry fill:#fcc"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},61257(e,t,i){i.d(t,{A:()=>n});const n=i.p+"assets/images/visualization_model_station-609c518cc1960b1805c57a0fe8127bea.png"},60185(e,t,i){i.d(t,{A:()=>n});const n=i.p+"assets/images/visualization_solid_lamp_1-118aab1957b0f7581c541baeedd54c87.png"},20450(e,t,i){i.d(t,{A:()=>n});const n=i.p+"assets/images/visualization_solid_lamp_2-4fe918803a8e1a259d88fa8c401c1482.png"},87875(e,t,i){i.d(t,{A:()=>n});const n=i.p+"assets/images/visualization_solid_signal-523efbd8e629bd5ff4a508d9e1ede67b.png"},45867(e,t,i){i.d(t,{A:()=>n});const n=i.p+"assets/images/visualization_solid_station-c7fb6708a0bffeee7dbe5167843e0bd3.png"},28453(e,t,i){i.d(t,{R:()=>o,x:()=>l});var n=i(96540);const a={},s=n.createContext(a);function o(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);